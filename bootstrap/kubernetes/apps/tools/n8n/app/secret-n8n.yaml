---
apiVersion: external-secrets.io/v1
kind: ExternalSecret
metadata:
  name: n8n-encryption-key
  namespace: tools
spec:
  target:
    name: n8n-encryption-key
    deletionPolicy: Delete
    template:
      type: Opaque
      data:
        encryption-key: |-
          {{ .encryption_key }}
  data:
    - secretKey: encryption_key
      sourceRef:
        storeRef:
          name: bitwarden-fields
          kind: ClusterSecretStore
      remoteRef:
        key: secret-n8n-encryption
        property: encryption-key
---
apiVersion: external-secrets.io/v1
kind: ExternalSecret
metadata:
  name: n8n-jwt-secret
  namespace: tools
spec:
  target:
    name: n8n-jwt-secret
    deletionPolicy: Delete
    template:
      type: Opaque
      data:
        jwt-secret: |-
          {{ .jwt_secret }}
  data:
    - secretKey: jwt_secret
      sourceRef:
        storeRef:
          name: bitwarden-fields
          kind: ClusterSecretStore
      remoteRef:
        key: secret-n8n-jwt
        property: jwt-secret
---
apiVersion: external-secrets.io/v1
kind: ExternalSecret
metadata:
  name: n8n-postgres-password
  namespace: tools
spec:
  target:
    name: n8n-postgres-password
    deletionPolicy: Delete
    template:
      type: Opaque
      data:
        postgres-password: |-
          {{ .postgres_password }}
  data:
    - secretKey: postgres_password
      sourceRef:
        storeRef:
          name: bitwarden-fields
          kind: ClusterSecretStore
      remoteRef:
        key: secret-n8n-postgres
        property: postgres-password