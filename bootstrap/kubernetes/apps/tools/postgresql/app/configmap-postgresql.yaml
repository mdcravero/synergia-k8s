---
apiVersion: v1
kind: ConfigMap
metadata:
  name: postgresql-values
  namespace: tools
data:
  values.yaml: |-
    global:
      postgresql:
        auth:
          existingSecret: "secret-postgresql"
          secretKeys:
            adminPasswordKey: password
            userPasswordKey: authentik-password

    image:
      registry: docker.io
      repository: bitnami/postgresql
      tag: 17.6.0
      digest: ""
      debug: true

    auth:
      enablePostgresUser: true
      existingSecret: "secret-postgresql"
      secretKeys:
        adminPasswordKey: password
        userPasswordKey: authentik-password
      usePasswordFiles: false
      database: "authentik"
      username: "authentik"

    primary:
      containerSecurityContext:
        enabled: true
        seLinuxOptions: {}
        runAsUser: 1000
        runAsGroup: 1000
        runAsNonRoot: true
        privileged: false
        readOnlyRootFilesystem: true
        allowPrivilegeEscalation: false
        capabilities:
          drop: ["ALL"]
        seccompProfile:
          type: "RuntimeDefault"
      podSecurityContext:
        enabled: true
        fsGroupChangePolicy: Always
        sysctls: []
        supplementalGroups: []
        fsGroup: 1000
        
      service:
        type: LoadBalancer
        ports:
          postgresql: 5432
        loadBalancerIP: 192.168.1.70
      
      persistence:
        enabled: true
        storageClass: nfs-client
        accessModes:
          - ReadWriteOnce
        size: 8Gi
      