apiVersion: v1
kind: ConfigMap
metadata:
  name: loki-stack-values
  namespace: monitoring
data:
  values.yaml: |
    loki:
      enabled: true
    
    deploymentMode: SingleBinary

    SingleBinary:
      replicas: 1
      retentionPeriod: 7d
      config:
        auth_enabled: false
        server:
          http_listen_port: 3100
          http_server_read_timeout: 5m
          http_server_write_timeout: 5m
          grpc_listen_port: 9095
          grpc_server_read_timeout: 5m
          grpc_server_write_timeout: 5m
        ingester:
          lifecycler:
            ring:
              kvstore:
                store: memberlist
              replication_factor: 1
            final_sleep: 0s
            heartbeat_timeout: 1m
            join_after: 0s
            num_tokens: 512
        schema_config:
          configs:
            - from: "2020-10-24"
              store: boltdb-shipper
              object_store: s3
              schema: v11
              index:
                prefix: loki_index_
                period: 24h
      
      persistence:
        enabled: true
        storageClassName: "nfs-client"
        accessModes:
          - ReadWriteMany
        size: 10Gi

    promtail:
      enabled: true

    grafana:
      enabled: false

